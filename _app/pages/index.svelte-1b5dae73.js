var De=Object.defineProperty;var ie=Object.getOwnPropertySymbols;var Ie=Object.prototype.hasOwnProperty,Ve=Object.prototype.propertyIsEnumerable;var ne=(a,e,r)=>e in a?De(a,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):a[e]=r,X=(a,e)=>{for(var r in e||(e={}))Ie.call(e,r)&&ne(a,r,e[r]);if(ie)for(var r of ie(e))Ve.call(e,r)&&ne(a,r,e[r]);return a};import{D as Le,S as ee,i as te,s as re,e as h,c as m,a as v,d as f,b as u,f as H,g as O,K as c,M as z,t as T,k as P,h as C,m as M,j as Q,q,w as ge,x as ye,y as ke,o as R,B as we,n as J,p as K,l as U,I as oe,U as Ee,L as xe,V as Se,N as Y,W as Ne}from"../chunks/vendor-e06a1edb.js";import{w as Be,m as qe}from"../chunks/stores-7846294e.js";const ce={librarypoint:"CRRL",mrl:"Massanutten",finditva:"Library of Virginia",nnpls:"Newport News",chesapeake:"chesapeake",rvl:"rvl",princewilliam:"princewilliam",brdc:"brdc",swvapub:"swvapub",vppl:"vppl",elprlibrary:"elprlibrary",yorkcountyva:"yorkcountyva",brooklyn:"brooklyn"},G=Le({});function Oe(a,e){const r=a,t=`https://${a}.overdrive.com`;console.log(`Look for ${e} at ${r}`);const l=new Request(`${t}/search?query=${e.replaceAll(" ","+")}&format=ebook-overdrive&sortBy=relevance`);fetch(l).then(i=>i.text()).then(i=>{const n=new DOMParser().parseFromString(i,"text/html"),o={type:"results",results:[]};if(n.getElementById("noresults")){const d=`No entry for ${e} at ${r}`;console.log(d)}else{const L=/window\.OverDrive\.titleCollection.*\n/.exec(n.head.innerHTML)[0].substring(35),I=JSON.parse(L.substring(0,L.length-2));console.log({books:I}),o.results=I.map(({id:b,title:$,isAvailable:S,firstCreatorName:E,covers:y})=>({id:b,title:$,isAvailable:S,firstCreatorName:E,cover:y.cover150Wide}))}G.update(d=>(d[e][r]=o,d))}).catch(i=>{console.log({err:i}),G.update(s=>(s[e][r]={type:"error",err:i},s))})}function Z(a,e){if(!a)return;console.log("Doing a search");const r=Object.fromEntries(e.map(t=>[t,{type:"querying"}]));r._meta={datetime:new Date().toISOString()},G.update(t=>(t[a]=X(X({},t[a]),r),t));for(const t of e)Oe(t,a)}function $e(a){let e,r;return{c(){e=h("div"),r=h("div"),this.h()},l(t){e=m(t,"DIV",{class:!0,style:!0});var l=v(e);r=m(l,"DIV",{class:!0}),v(r).forEach(f),l.forEach(f),this.h()},h(){u(r,"class","rainbow border-r-[#88C5CC] dark:border-r-[#FFD05B] svelte-uawhdf"),u(e,"class","wrapper inline-block absolute -mt-0.5 ml-2 svelte-uawhdf"),H(e,"--size",a[2]+a[0]),H(e,"--duration",a[1])},m(t,l){O(t,e,l),c(e,r)},p(t,[l]){l&5&&H(e,"--size",t[2]+t[0]),l&2&&H(e,"--duration",t[1])},i:z,o:z,d(t){t&&f(e)}}}function Te(a,e,r){let{unit:t="px"}=e,{duration:l="1.5s"}=e,{size:i="40"}=e;return a.$$set=s=>{"unit"in s&&r(0,t=s.unit),"duration"in s&&r(1,l=s.duration),"size"in s&&r(2,i=s.size)},[t,l,i]}class Ce extends ee{constructor(e){super();te(this,e,Te,$e,re,{unit:0,duration:1,size:2})}}function ue(a,e,r){const t=a.slice();return t[2]=e[r].id,t[3]=e[r].title,t[4]=e[r].isAvailable,t[5]=e[r].firstCreatorName,t[6]=e[r].cover,t}function fe(a){let e,r,t,l=ce[a[0]]+"",i,s,n,o,k,d,V,L,I,b=a[1].type==="querying"&&de();function $(y,_){return y[1].type==="error"?je:y[1].type==="querying"?Re:y[1].results.length==0?Me:Pe}let S=$(a),E=S(a);return{c(){e=h("div"),r=h("div"),t=h("h5"),i=T(l),s=P(),b&&b.c(),n=P(),o=h("p"),k=T(a[0]),d=P(),V=h("div"),L=h("ul"),E.c(),this.h()},l(y){e=m(y,"DIV",{class:!0});var _=v(e);r=m(_,"DIV",{class:!0});var g=v(r);t=m(g,"H5",{class:!0});var w=v(t);i=C(w,l),s=M(w),b&&b.l(w),w.forEach(f),n=M(g),o=m(g,"P",{class:!0});var p=v(o);k=C(p,a[0]),p.forEach(f),g.forEach(f),d=M(_),V=m(_,"DIV",{class:!0});var x=v(V);L=m(x,"UL",{class:!0});var B=v(L);E.l(B),B.forEach(f),x.forEach(f),_.forEach(f),this.h()},h(){u(t,"class","text-xl font-bold leading-none text-gray-900 dark:text-white"),u(o,"class","text-sm text-gray-500 truncate dark:text-gray-400"),u(r,"class","flex flex-col justify-between items-start mb-4"),u(L,"class","divide-y divide-gray-200 dark:divide-gray-700"),u(V,"class","flow-root"),u(e,"class","p-4 my-4 mx-auto max-w-2xl bg-white rounded-lg border shadow-md sm:p-8 dark:bg-gray-800 dark:border-gray-700")},m(y,_){O(y,e,_),c(e,r),c(r,t),c(t,i),c(t,s),b&&b.m(t,null),c(r,n),c(r,o),c(o,k),c(e,d),c(e,V),c(V,L),E.m(L,null),I=!0},p(y,_){(!I||_&1)&&l!==(l=ce[y[0]]+"")&&Q(i,l),y[1].type==="querying"?b?_&2&&q(b,1):(b=de(),b.c(),q(b,1),b.m(t,null)):b&&(J(),R(b,1,1,()=>{b=null}),K()),(!I||_&1)&&Q(k,y[0]),S===(S=$(y))&&E?E.p(y,_):(E.d(1),E=S(y),E&&(E.c(),E.m(L,null)))},i(y){I||(q(b),I=!0)},o(y){R(b),I=!1},d(y){y&&f(e),b&&b.d(),E.d()}}}function de(a){let e,r;return e=new Ce({}),{c(){ge(e.$$.fragment)},l(t){ye(e.$$.fragment,t)},m(t,l){ke(e,t,l),r=!0},i(t){r||(q(e.$$.fragment,t),r=!0)},o(t){R(e.$$.fragment,t),r=!1},d(t){we(e,t)}}}function Pe(a){let e,r=a[1].results,t=[];for(let l=0;l<r.length;l+=1)t[l]=he(ue(a,r,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=U()},l(l){for(let i=0;i<t.length;i+=1)t[i].l(l);e=U()},m(l,i){for(let s=0;s<t.length;s+=1)t[s].m(l,i);O(l,e,i)},p(l,i){if(i&3){r=l[1].results;let s;for(s=0;s<r.length;s+=1){const n=ue(l,r,s);t[s]?t[s].p(n,i):(t[s]=he(n),t[s].c(),t[s].m(e.parentNode,e))}for(;s<t.length;s+=1)t[s].d(1);t.length=r.length}},d(l){Ee(t,l),l&&f(e)}}}function Me(a){let e,r,t,l,i;return{c(){e=h("li"),r=h("div"),t=h("div"),l=h("p"),i=T("No results"),this.h()},l(s){e=m(s,"LI",{class:!0});var n=v(e);r=m(n,"DIV",{class:!0});var o=v(r);t=m(o,"DIV",{class:!0});var k=v(t);l=m(k,"P",{class:!0});var d=v(l);i=C(d,"No results"),d.forEach(f),k.forEach(f),o.forEach(f),n.forEach(f),this.h()},h(){u(l,"class","text-sm font-medium text-gray-900 truncate dark:text-white"),u(t,"class","flex-1 min-w-0"),u(r,"class","flex items-center space-x-4"),u(e,"class","py-3 sm:py-4")},m(s,n){O(s,e,n),c(e,r),c(r,t),c(t,l),c(l,i)},p:z,d(s){s&&f(e)}}}function Re(a){let e,r,t,l,i;return{c(){e=h("li"),r=h("div"),t=h("div"),l=h("p"),i=T("Querying"),this.h()},l(s){e=m(s,"LI",{class:!0});var n=v(e);r=m(n,"DIV",{class:!0});var o=v(r);t=m(o,"DIV",{class:!0});var k=v(t);l=m(k,"P",{class:!0});var d=v(l);i=C(d,"Querying"),d.forEach(f),k.forEach(f),o.forEach(f),n.forEach(f),this.h()},h(){u(l,"class","text-sm font-medium text-gray-900 truncate dark:text-white"),u(t,"class","flex-1 min-w-0"),u(r,"class","flex items-center space-x-4"),u(e,"class","py-3 sm:py-4")},m(s,n){O(s,e,n),c(e,r),c(r,t),c(t,l),c(l,i)},p:z,d(s){s&&f(e)}}}function je(a){let e,r,t,l,i;return{c(){e=h("li"),r=h("div"),t=h("div"),l=h("p"),i=T("Error"),this.h()},l(s){e=m(s,"LI",{class:!0});var n=v(e);r=m(n,"DIV",{class:!0});var o=v(r);t=m(o,"DIV",{class:!0});var k=v(t);l=m(k,"P",{class:!0});var d=v(l);i=C(d,"Error"),d.forEach(f),k.forEach(f),o.forEach(f),n.forEach(f),this.h()},h(){u(l,"class","text-sm font-medium text-gray-900 truncate dark:text-white"),u(t,"class","flex-1 min-w-0"),u(r,"class","flex items-center space-x-4"),u(e,"class","py-3 sm:py-4")},m(s,n){O(s,e,n),c(e,r),c(r,t),c(t,l),c(l,i)},p:z,d(s){s&&f(e)}}}function ze(a){let e;return{c(){e=T("unavailable")},l(r){e=C(r,"unavailable")},m(r,t){O(r,e,t)},d(r){r&&f(e)}}}function Ue(a){let e;return{c(){e=T("available")},l(r){e=C(r,"available")},m(r,t){O(r,e,t)},d(r){r&&f(e)}}}function he(a){let e,r,t,l,i,s,n,o,k,d,V,L=a[3]+"",I,b,$,S,E=a[5]+"",y,_,g,w;function p(D,N){return D[4]?Ue:ze}let x=p(a),B=x(a);return{c(){e=h("li"),r=h("div"),t=h("div"),l=h("a"),i=h("img"),k=P(),d=h("div"),V=h("a"),I=T(L),$=P(),S=h("p"),y=T(E),_=P(),g=h("div"),B.c(),w=P(),this.h()},l(D){e=m(D,"LI",{class:!0});var N=v(e);r=m(N,"DIV",{class:!0});var j=v(r);t=m(j,"DIV",{class:!0});var A=v(t);l=m(A,"A",{href:!0,class:!0});var F=v(l);i=m(F,"IMG",{class:!0,src:!0,alt:!0}),F.forEach(f),A.forEach(f),k=M(j),d=m(j,"DIV",{class:!0});var W=v(d);V=m(W,"A",{href:!0,class:!0});var le=v(V);I=C(le,L),le.forEach(f),$=M(W),S=m(W,"P",{class:!0});var se=v(S);y=C(se,E),se.forEach(f),W.forEach(f),_=M(j),g=m(j,"DIV",{class:!0});var ae=v(g);B.l(ae),ae.forEach(f),j.forEach(f),w=M(N),N.forEach(f),this.h()},h(){u(i,"class","h-16"),oe(i.src,s=a[6].href)||u(i,"src",s),u(i,"alt",n=a[3]+" cover"),u(l,"href",o=`https://${a[0]}.overdrive.com/media/${a[2]}`),u(l,"class","text-sm font-medium text-gray-900 dark:text-white"),u(t,"class","flex-shrink-0"),u(V,"href",b=`https://${a[0]}.overdrive.com/media/${a[2]}`),u(V,"class","text-sm font-medium text-gray-900 dark:text-white"),u(S,"class","text-sm text-gray-500 truncate dark:text-gray-400"),u(d,"class","flex-1 min-w-0"),u(g,"class","inline-flex items-center text-base font-semibold text-gray-900 dark:text-white"),u(r,"class","flex items-center space-x-4"),u(e,"class","py-3 sm:py-4")},m(D,N){O(D,e,N),c(e,r),c(r,t),c(t,l),c(l,i),c(r,k),c(r,d),c(d,V),c(V,I),c(d,$),c(d,S),c(S,y),c(r,_),c(r,g),B.m(g,null),c(e,w)},p(D,N){N&2&&!oe(i.src,s=D[6].href)&&u(i,"src",s),N&2&&n!==(n=D[3]+" cover")&&u(i,"alt",n),N&3&&o!==(o=`https://${D[0]}.overdrive.com/media/${D[2]}`)&&u(l,"href",o),N&2&&L!==(L=D[3]+"")&&Q(I,L),N&3&&b!==(b=`https://${D[0]}.overdrive.com/media/${D[2]}`)&&u(V,"href",b),N&2&&E!==(E=D[5]+"")&&Q(y,E),x!==(x=p(D))&&(B.d(1),B=x(D),B&&(B.c(),B.m(g,null)))},d(D){D&&f(e),B.d()}}}function Ae(a){let e,r,t=a[0]!=="_meta"&&fe(a);return{c(){t&&t.c(),e=U()},l(l){t&&t.l(l),e=U()},m(l,i){t&&t.m(l,i),O(l,e,i),r=!0},p(l,[i]){l[0]!=="_meta"?t?(t.p(l,i),i&1&&q(t,1)):(t=fe(l),t.c(),q(t,1),t.m(e.parentNode,e)):t&&(J(),R(t,1,1,()=>{t=null}),K())},i(l){r||(q(t),r=!0)},o(l){R(t),r=!1},d(l){t&&t.d(l),l&&f(e)}}}function Fe(a,e,r){let{library:t}=e,{results:l}=e;return a.$$set=i=>{"library"in i&&r(0,t=i.library),"results"in i&&r(1,l=i.results)},[t,l]}class We extends ee{constructor(e){super();te(this,e,Fe,Ae,re,{library:0,results:1})}}function me(a,e,r){const t=a.slice();return t[7]=e[r][0],t[8]=e[r][1],t[10]=r,t}function ve(a){let e,r,t=Object.entries(a[1][a[0]]),l=[];for(let s=0;s<t.length;s+=1)l[s]=_e(me(a,t,s));const i=s=>R(l[s],1,1,()=>{l[s]=null});return{c(){for(let s=0;s<l.length;s+=1)l[s].c();e=U()},l(s){for(let n=0;n<l.length;n+=1)l[n].l(s);e=U()},m(s,n){for(let o=0;o<l.length;o+=1)l[o].m(s,n);O(s,e,n),r=!0},p(s,n){if(n&3){t=Object.entries(s[1][s[0]]);let o;for(o=0;o<t.length;o+=1){const k=me(s,t,o);l[o]?(l[o].p(k,n),q(l[o],1)):(l[o]=_e(k),l[o].c(),q(l[o],1),l[o].m(e.parentNode,e))}for(J(),o=t.length;o<l.length;o+=1)i(o);K()}},i(s){if(!r){for(let n=0;n<t.length;n+=1)q(l[n]);r=!0}},o(s){l=l.filter(Boolean);for(let n=0;n<l.length;n+=1)R(l[n]);r=!1},d(s){Ee(l,s),s&&f(e)}}}function _e(a){let e,r;return e=new We({props:{library:a[7],results:a[8]}}),{c(){ge(e.$$.fragment)},l(t){ye(e.$$.fragment,t)},m(t,l){ke(e,t,l),r=!0},p(t,l){const i={};l&3&&(i.library=t[7]),l&3&&(i.results=t[8]),e.$set(i)},i(t){r||(q(e.$$.fragment,t),r=!0)},o(t){R(e.$$.fragment,t),r=!1},d(t){we(e,t)}}}function be(a){let e,r,t,l,i;return{c(){e=h("div"),r=h("button"),t=T("Search Wishlist Libraries"),this.h()},l(s){e=m(s,"DIV",{class:!0});var n=v(e);r=m(n,"BUTTON",{class:!0});var o=v(r);t=C(o,"Search Wishlist Libraries"),o.forEach(f),n.forEach(f),this.h()},h(){u(r,"class","font-sans font-semibold tracking-wide mx-auto text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"),u(e,"class","container mx-auto my-4 px-4 flex items-center")},m(s,n){O(s,e,n),c(e,r),c(r,t),l||(i=xe(r,"click",a[3]),l=!0)},p:z,d(s){s&&f(e),l=!1,i()}}}function pe(a){let e,r,t,l,i;return{c(){e=h("div"),r=h("button"),t=T("Search Brooklyn"),this.h()},l(s){e=m(s,"DIV",{class:!0});var n=v(e);r=m(n,"BUTTON",{class:!0});var o=v(r);t=C(o,"Search Brooklyn"),o.forEach(f),n.forEach(f),this.h()},h(){u(r,"class","font-sans font-semibold tracking-wide mx-auto text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"),u(e,"class","container mx-auto my-4 px-4 flex items-center")},m(s,n){O(s,e,n),c(e,r),c(r,t),l||(i=xe(r,"click",a[4]),l=!0)},p:z,d(s){s&&f(e),l=!1,i()}}}function He(a){let e,r,t,l,i,s,n,o,k,d,V,L,I,b,$,S,E,y,_=a[1][a[0]]&&ve(a),g=a[0]in a[1]&&!("chesapeake"in a[1][a[0]])&&be(a),w=a[0]in a[1]&&!("brooklyn"in a[1][a[0]])&&pe(a);return{c(){e=h("div"),r=h("div"),t=h("form"),l=h("div"),i=h("label"),s=T("Search your libraries"),n=P(),o=h("input"),k=P(),d=h("button"),V=T("Submit"),L=P(),I=h("div"),_&&_.c(),b=P(),g&&g.c(),$=P(),w&&w.c(),this.h()},l(p){e=m(p,"DIV",{class:!0});var x=v(e);r=m(x,"DIV",{class:!0});var B=v(r);t=m(B,"FORM",{});var D=v(t);l=m(D,"DIV",{class:!0});var N=v(l);i=m(N,"LABEL",{for:!0,class:!0});var j=v(i);s=C(j,"Search your libraries"),j.forEach(f),n=M(N),o=m(N,"INPUT",{name:!0,type:!0,id:!0,class:!0,placeholder:!0}),N.forEach(f),k=M(D),d=m(D,"BUTTON",{type:!0,class:!0});var A=v(d);V=C(A,"Submit"),A.forEach(f),D.forEach(f),B.forEach(f),L=M(x),I=m(x,"DIV",{class:!0});var F=v(I);_&&_.l(F),F.forEach(f),b=M(x),g&&g.l(x),$=M(x),w&&w.l(x),x.forEach(f),this.h()},h(){u(i,"for","terms"),u(i,"class","block pl-1 mb-2 font-sans text-sm font-medium text-gray-900 dark:text-gray-300"),u(o,"name","terms"),u(o,"type","text"),u(o,"id","terms"),u(o,"class","bg-gray-50 border border-gray-300 text-gray-900 font-sans text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2.5 dark:bg-gray-700 dark:border-gray-600 dark:placeholder-gray-400 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"),u(o,"placeholder","Terms..."),o.required=!0,u(l,"class","mb-6"),u(d,"type","submit"),u(d,"class","font-sans font-semibold tracking-wide text-white bg-blue-700 hover:bg-blue-800 focus:ring-4 focus:ring-blue-300 font-medium rounded-lg text-sm w-full sm:w-auto px-5 py-2.5 text-center dark:bg-blue-600 dark:hover:bg-blue-700 dark:focus:ring-blue-800"),u(r,"class","container mx-auto px-4"),u(I,"class","container mx-auto px-4"),u(e,"class","h-full min-h-screen py-8 bg-slate-100 dark:bg-slate-700")},m(p,x){O(p,e,x),c(e,r),c(r,t),c(t,l),c(l,i),c(i,s),c(l,n),c(l,o),c(t,k),c(t,d),c(d,V),c(e,L),c(e,I),_&&_.m(I,null),c(e,b),g&&g.m(e,null),c(e,$),w&&w.m(e,null),S=!0,E||(y=Se(a[2].call(null,t)),E=!0)},p(p,[x]){p[1][p[0]]?_?(_.p(p,x),x&3&&q(_,1)):(_=ve(p),_.c(),q(_,1),_.m(I,null)):_&&(J(),R(_,1,1,()=>{_=null}),K()),p[0]in p[1]&&!("chesapeake"in p[1][p[0]])?g?g.p(p,x):(g=be(p),g.c(),g.m(e,$)):g&&(g.d(1),g=null),p[0]in p[1]&&!("brooklyn"in p[1][p[0]])?w?w.p(p,x):(w=pe(p),w.c(),w.m(e,null)):w&&(w.d(1),w=null)},i(p){S||(q(_),S=!0)},o(p){R(_),S=!1},d(p){p&&f(e),_&&_.d(),g&&g.d(),w&&w.d(),E=!1,y()}}}const Xe=!0;function Qe(a,e,r){let t,l,i;Y(a,Be,d=>r(6,t=d)),Y(a,qe,d=>r(5,l=d)),Y(a,G,d=>r(1,i=d));let s;const{form:n}=Ne({onSubmit:d=>{console.log("setting terms"),r(0,s=d.terms)}});function o(){Z(s,t)}function k(){Z(s,["brooklyn"])}return a.$$.update=()=>{a.$$.dirty&33&&Z(s,l)},[s,i,n,o,k,l]}class Ye extends ee{constructor(e){super();te(this,e,Qe,He,re,{})}}export{Ye as default,Xe as prerender};
